# WebSnap Vercel éƒ¨ç½²æ£€æŸ¥æ¸…å•

## âœ… é…ç½®æ–‡ä»¶æ£€æŸ¥

### 1. vercel.json é…ç½®éªŒè¯
- [x] **version**: 2 âœ…
- [x] **buildsé…ç½®**: æ­£ç¡®åŒ…å«@vercel/nodeå’Œ@vercel/static âœ…
- [x] **includeFiles**: æ­£ç¡®æ ¼å¼ä¸ºå­—ç¬¦ä¸² `"node_modules/@sparticuz/chromium/**"` âœ…
- [x] **maxLambdaSize**: 50mb âœ…
- [x] **routesé…ç½®**: åŒ…å«æ‰€æœ‰å¿…è¦è·¯ç”± âœ…
- [x] **functionsé…ç½®**: maxDuration 120ç§’, memory 3008MB âœ…
- [x] **ç¯å¢ƒå˜é‡**: PUPPETEERé…ç½®æ­£ç¡® âœ…

### 2. package.json ä¾èµ–æ£€æŸ¥
- [x] **@sparticuz/chromium**: ^121.0.0 âœ…
- [x] **puppeteer-core**: ^21.0.0 âœ…
- [x] **express**: ^4.18.2 âœ…
- [x] **Node.jsç‰ˆæœ¬**: 18.x âœ…

## ğŸ”§ ä¿®å¤çš„å…³é”®é—®é¢˜

### åŸå§‹é”™è¯¯
```
Invalid request: 'functions.api/screenshot.js.includeFiles' should be string.
```

### ä¿®å¤å†…å®¹
1. **ç§»åŠ¨includeFilesä½ç½®**:
   ```json
   // âŒ é”™è¯¯ä½ç½®
   "functions": {
     "api/screenshot.js": {
       "includeFiles": ["..."]  // æ•°ç»„æ ¼å¼é”™è¯¯
     }
   }
   
   // âœ… æ­£ç¡®ä½ç½®
   "builds": [{
     "config": {
       "includeFiles": "node_modules/@sparticuz/chromium/**"  // å­—ç¬¦ä¸²æ ¼å¼æ­£ç¡®
     }
   }]
   ```

2. **ä¿®å¤æ•°æ®ç±»å‹**:
   - ä»æ•°ç»„ `["node_modules/@sparticuz/chromium/**"]`
   - æ”¹ä¸ºå­—ç¬¦ä¸² `"node_modules/@sparticuz/chromium/**"`

3. **å®Œå–„é…ç½®ç»“æ„**:
   - ä½¿ç”¨æ ‡å‡†çš„builds + routes + functionsç»“æ„
   - ç§»é™¤è¿‡æ—¶çš„é…ç½®è¯­æ³•

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. é¢„éƒ¨ç½²æ£€æŸ¥
```bash
# æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•
cat vercel.json | jq .

# éªŒè¯ä¾èµ–å®‰è£…
npm list @sparticuz/chromium puppeteer-core

# æœ¬åœ°æµ‹è¯•
npm start
```

### 2. éƒ¨ç½²å‘½ä»¤
```bash
# å®‰è£…Vercel CLI
npm i -g vercel

# ç™»å½•
vercel login

# éƒ¨ç½²
vercel --prod
```

### 3. éƒ¨ç½²åéªŒè¯
```bash
# ä½¿ç”¨æµ‹è¯•è„šæœ¬
VERCEL_URL=https://your-app.vercel.app node test-vercel-deployment.js

# æ‰‹åŠ¨æµ‹è¯•
curl https://your-app.vercel.app/api/health
```

## ğŸ¯ åŠŸèƒ½å…¼å®¹æ€§ç¡®è®¤

### islanddragon.cn ä¼˜åŒ–åŠŸèƒ½
- [x] **120ç§’è¶…æ—¶**: æ”¯æŒé•¿æ—¶é—´æ¸²æŸ“ âœ…
- [x] **3GBå†…å­˜**: å¤„ç†å¤§å‹é¡µé¢ âœ…
- [x] **å¢å¼ºç­‰å¾…ç­–ç•¥**: ä¿æŒæ‰€æœ‰ä¼˜åŒ– âœ…
- [x] **å¤šé˜¶æ®µæ£€æµ‹**: å®Œæ•´ä¿ç•™ âœ…

### å…¶ä»–ç½‘ç«™å…¼å®¹æ€§
- [x] **æ ‡å‡†æµç¨‹**: ä¸å—å½±å“ âœ…
- [x] **æ€§èƒ½ä¿æŒ**: åŸæœ‰é€Ÿåº¦ âœ…
- [x] **é”™è¯¯å¤„ç†**: å®Œæ•´ä¿ç•™ âœ…

### æ ¸å¿ƒåŠŸèƒ½
- [x] **URLè‡ªåŠ¨è¡¥å…¨**: å‰åç«¯æ”¯æŒ âœ…
- [x] **è®¾å¤‡é€‚é…**: æ¡Œé¢/ç§»åŠ¨/å¹³æ¿ âœ…
- [x] **è´¨é‡è®¾ç½®**: é«˜/ä¸­/ä½ âœ…
- [x] **é”™è¯¯å¤„ç†**: è¯¦ç»†æç¤º âœ…

## âš ï¸ Vercelç¯å¢ƒæ³¨æ„äº‹é¡¹

### 1. èµ„æºé™åˆ¶
- **æ‰§è¡Œæ—¶é—´**: æœ€å¤§120ç§’ âœ…
- **å†…å­˜**: æœ€å¤§3008MB âœ…
- **åŒ…å¤§å°**: æœ€å¤§50MB âœ…
- **å¹¶å‘**: æ ¹æ®è®¡åˆ’é™åˆ¶

### 2. å†·å¯åŠ¨å½±å“
- é¦–æ¬¡è¯·æ±‚å¯èƒ½éœ€è¦é¢å¤–10-20ç§’
- å»ºè®®åœ¨æµ‹è¯•æ—¶è€ƒè™‘å†·å¯åŠ¨æ—¶é—´
- é¢‘ç¹ä½¿ç”¨å¯ä¿æŒçƒ­å¯åŠ¨çŠ¶æ€

### 3. ç¯å¢ƒå·®å¼‚
- æœ¬åœ°ä½¿ç”¨æœ¬åœ°Chrome
- Vercelä½¿ç”¨@sparticuz/chromium
- è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒå¹¶åˆ‡æ¢é…ç½®

## ğŸ” æ•…éšœæ’é™¤æŒ‡å—

### å¸¸è§éƒ¨ç½²é—®é¢˜
1. **é…ç½®è¯­æ³•é”™è¯¯**:
   ```bash
   # éªŒè¯JSONè¯­æ³•
   cat vercel.json | jq .
   ```

2. **ä¾èµ–ç¼ºå¤±**:
   ```bash
   # é‡æ–°å®‰è£…ä¾èµ–
   rm -rf node_modules package-lock.json
   npm install
   ```

3. **å‡½æ•°è¶…æ—¶**:
   - æ£€æŸ¥maxDurationè®¾ç½®
   - éªŒè¯å†…å­˜é…ç½®
   - æŸ¥çœ‹å‡½æ•°æ—¥å¿—

### è°ƒè¯•æŠ€å·§
- ä½¿ç”¨Vercelä»ªè¡¨æ¿æŸ¥çœ‹æ—¥å¿—
- æœ¬åœ°æ¨¡æ‹ŸVercelç¯å¢ƒå˜é‡
- é€æ­¥æµ‹è¯•å„ä¸ªåŠŸèƒ½

## ğŸ“Š æ€§èƒ½ç›‘æ§

### å…³é”®æŒ‡æ ‡
- **æˆåŠŸç‡**: ç›®æ ‡ >95%
- **å¹³å‡å“åº”æ—¶é—´**: 
  - ç®€å•ç½‘ç«™: <30ç§’
  - islanddragon.cn: <120ç§’
- **é”™è¯¯ç‡**: <5%

### ç›‘æ§æ–¹æ³•
- Vercel Analytics
- è‡ªå®šä¹‰ç›‘æ§è„šæœ¬
- å®šæœŸå¥åº·æ£€æŸ¥

## ğŸ‰ éƒ¨ç½²æˆåŠŸæ ‡å‡†

### å¿…é¡»é€šè¿‡çš„æµ‹è¯•
1. âœ… å¥åº·æ£€æŸ¥è¿”å›200
2. âœ… ç®€å•ç½‘ç«™æˆªå›¾æˆåŠŸ
3. âœ… islanddragon.cnæˆªå›¾æˆåŠŸ
4. âœ… URLè‡ªåŠ¨è¡¥å…¨å·¥ä½œ
5. âœ… é”™è¯¯å¤„ç†æ­£ç¡®

### æ€§èƒ½è¦æ±‚
- åŸºç¡€åŠŸèƒ½å“åº”æ—¶é—´ <60ç§’
- islanddragon.cnå“åº”æ—¶é—´ <120ç§’
- å†…å­˜ä½¿ç”¨ <3GB
- æˆåŠŸç‡ >95%

## ğŸ”— æœ‰ç”¨èµ„æº

- [Vercelæ–‡æ¡£](https://vercel.com/docs)
- [Puppeteeræ–‡æ¡£](https://pptr.dev/)
- [@sparticuz/chromium](https://github.com/Sparticuz/chromium)
- [WebSnapé¡¹ç›®ä»“åº“](https://github.com/your-repo)

ç°åœ¨WebSnapå·²ç»å®Œå…¨å‡†å¤‡å¥½éƒ¨ç½²åˆ°Vercelï¼Œæ‰€æœ‰é…ç½®é—®é¢˜éƒ½å·²è§£å†³ï¼
